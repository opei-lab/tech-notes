
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>æ³¨é‡ˆä»˜ã Dockerfileï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f9fafb;
      padding: 2rem;
      display: flex;
      flex-direction: row;
      gap: 2rem;
    }
    pre {
      background-color: #1e1e1e;
      color: #d4d4d4;
      padding: 1rem;
      border-radius: 8px;
      overflow-x: auto;
      line-height: 1.6;
      min-width: 500px;
    }
    .token {
      position: relative;
      border-bottom: 1px dotted #aaa;
      cursor: help;
    }
    .info-box {
      font-size: 0.95rem;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 1rem;
      line-height: 1.6;
    }
    .directory-info {
      font-size: 0.85rem;
      background: #fefefe;
      border: 1px dashed #aaa;
      border-radius: 8px;
      padding: 1rem;
      margin-top: 1rem;
    }
    .code-container {
      display: flex;
      flex-direction: column;
    }
  </style>
</head>
<body>
  <div class="code-container">
    <h2>ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆPythonï¼‰</h2>
    <pre>
<span class="token" title="ã‚³ãƒ¡ãƒ³ãƒˆï¼šãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ãƒ“ãƒ«ãƒ‰é–‹å§‹ã‚’ç¤ºã™ã‚³ãƒ¡ãƒ³ãƒˆã§ã™"># --- 2. Build backend + bundle static files ---</span>
<span class="token" title="ã‚³ãƒ¡ãƒ³ãƒˆï¼šPythonã®è»½é‡ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ™ãƒ¼ã‚¹ã«ä½¿ç”¨ã€‚ASã§åˆ¥åruntimeã‚’æŒ‡å®šã—ã€å¾Œã‹ã‚‰å‚ç…§å¯èƒ½ã«ã—ã¾ã™ã€‚">FROM python:3.10-slim AS runtime</span>
<span class="token" title="ã‚³ãƒ¡ãƒ³ãƒˆï¼šä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ /app ã«è¨­å®šã€‚ä»¥é™ã®å‘½ä»¤ã¯ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåŸºæº–ã§å‹•ä½œã—ã¾ã™ã€‚">WORKDIR /app</span>

<span class="token" title="ã‚³ãƒ¡ãƒ³ãƒˆï¼šPythonä¾å­˜é–¢ä¿‚ã®ä¸€è¦§ã‚’ã‚³ãƒ”ãƒ¼"># Python ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</span>
<span class="token" title="ã‚³ãƒ¡ãƒ³ãƒˆï¼šrequirements.txtï¼ˆãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã‚’ã‚³ãƒ”ãƒ¼">COPY requirements.txt ./</span>
<span class="token" title="ã‚³ãƒ¡ãƒ³ãƒˆï¼špip install ã‚’ä½¿ã£ã¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚--no-cache-dir ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ®‹ã•ãšè»½é‡åŒ–ã€‚">RUN pip install --no-cache-dir -r requirements.txt</span>

<span class="token" title="ã‚³ãƒ¡ãƒ³ãƒˆï¼šãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹"># ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚³ãƒ¼ãƒ‰ã‚³ãƒ”ãƒ¼</span>
<span class="token" title="ã‚³ãƒ¡ãƒ³ãƒˆï¼šmain.pyï¼ˆã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆï¼‰ã‚’ã‚³ãƒ”ãƒ¼">COPY main.py .</span>
<span class="token" title="ã‚³ãƒ¡ãƒ³ãƒˆï¼šãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å‡¦ç†ã‚’å«ã‚€ routes ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ã‚³ãƒ”ãƒ¼">COPY routes/ ./routes/</span>
<span class="token" title="ã‚³ãƒ¡ãƒ³ãƒˆï¼šãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãªã©ã‚’å«ã‚€ services ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ã‚³ãƒ”ãƒ¼">COPY services/ ./services/</span>

<span class="token" title="ã‚³ãƒ¡ãƒ³ãƒˆï¼šãƒ“ãƒ«ãƒ‰æ¸ˆã¿ãƒ•ãƒ­ãƒ³ãƒˆï¼ˆé™çš„ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã‚’ã“ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã«å–ã‚Šè¾¼ã‚€"># ãƒ“ãƒ«ãƒ‰æ¸ˆã¿ãƒ•ãƒ­ãƒ³ãƒˆé™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®</span>
<span class="token" title="ã‚³ãƒ¡ãƒ³ãƒˆï¼šfrontend-builder ã‚¹ãƒ†ãƒ¼ã‚¸ã‹ã‚‰ dist å‡ºåŠ›ã‚’ã‚³ãƒ”ãƒ¼ã—ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚’è¡¨ç¤ºå¯èƒ½ã«ã—ã¾ã™">COPY --from=frontend-builder /app/frontend/dist ./frontend/dist</span>

<span class="token" title="ã‚³ãƒ¡ãƒ³ãƒˆï¼šã‚¢ãƒ—ãƒªã®ç’°å¢ƒå¤‰æ•°ã‚’ã“ã“ã§è¨­å®šï¼ˆä¾‹ï¼šãƒãƒ¼ãƒˆç•ªå·ã‚„OAuthã®è¨­å®šåãªã©ï¼‰"># ç’°å¢ƒå¤‰æ•°ï¼ˆå¿…è¦ã«å¿œã˜ã¦ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆåãªã©ï¼‰</span>
<span class="token" title="ã‚³ãƒ¡ãƒ³ãƒˆï¼šFastAPIç­‰ã§ä½¿ç”¨ã™ã‚‹èµ·å‹•ãƒãƒ¼ãƒˆã¨OAuthã®ç§˜å¯†åã‚’ç’°å¢ƒå¤‰æ•°ã§æŒ‡å®š">ENV PORT=8080 \</span>
<span class="token" title="ã‚³ãƒ¡ãƒ³ãƒˆï¼šOAuthèªè¨¼æ™‚ã«ä½¿ã†Secret Managerãªã©ã®åå‰ã€‚">    OAUTH_SECRET_NAME=youtube-oauth</span>

<span class="token" title="ã‚³ãƒ¡ãƒ³ãƒˆï¼šFastAPIã‚’uvicornã§èµ·å‹•ã€‚ãƒ›ã‚¹ãƒˆ0.0.0.0ã¯å¤–éƒ¨ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã€PORTã¯ä¸Šè¨˜ENVã‚’ä½¿ç”¨"># ã‚¢ãƒ—ãƒªèµ·å‹•</span>
<span class="token" title="ã‚³ãƒ¡ãƒ³ãƒˆï¼šmain.pyã®FastAPIã‚¢ãƒ—ãƒª(main:app)ã‚’èµ·å‹•">CMD uvicorn main:app --host 0.0.0.0 --port ${PORT:-8080}</span>
    </pre>
  </div>

  <div class="info-box">
    <strong>ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç’°å¢ƒã®è§£èª¬ï¼š</strong>
    <ol>
      <li>ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¯APIã‚„ã‚µãƒ¼ãƒãƒ¼å‡¦ç†ã®éƒ¨åˆ†ã‚’æ‹…ã„ã¾ã™ã€‚</li>
      <li>Pythonã¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºã«äººæ°—ã®è¨€èªã§ã™ã€‚</li>
      <li>å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ <code>requirements.txt</code> ã«æ›¸ãã€<code>pip install</code> ã§ä¸€æ‹¬ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚</li>
      <li><code>main.py</code> ãŒã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã€‚ãƒ«ãƒ¼ãƒˆå‡¦ç†ã¯ <code>routes/</code>ã€ãƒ“ã‚¸ãƒã‚¹å‡¦ç†ã¯ <code>services/</code> ã«åˆ†ã‘ã¦ç®¡ç†ã€‚</li>
      <li>ãƒ“ãƒ«ãƒ‰æ¸ˆã¿ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚’ä¸€ç·’ã«å«ã‚ã‚‹ã“ã¨ã§ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã ã‘ã§é…ä¿¡å¯èƒ½ã«ãªã‚Šã¾ã™ã€‚</li>
      <li><code>uvicorn</code> ã¯Pythonã§éåŒæœŸWebã‚µãƒ¼ãƒãƒ¼ã‚’ç«‹ã¦ã‚‹ãŸã‚ã®è»½é‡ã‚µãƒ¼ãƒãƒ¼ã§ã™ã€‚</li>
    </ol>
   
    <div class="directory-info">
      ğŸ“ /app/<br>
      â”œâ”€ main.py ï¼ˆFastAPIã‚¢ãƒ—ãƒªèµ·å‹•ãƒã‚¤ãƒ³ãƒˆï¼‰<br>
      â”œâ”€ requirements.txtï¼ˆä¾å­˜ä¸€è¦§ï¼‰<br>
      â”œâ”€ routes/ ï¼ˆãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼šAPIã®URLå‡¦ç†ï¼‰<br>
      â”œâ”€ services/ ï¼ˆå‡¦ç†ãƒ­ã‚¸ãƒƒã‚¯ï¼‰<br>
      â””â”€ frontend/dist/ ï¼ˆé™çš„ãƒ•ã‚¡ã‚¤ãƒ«ï¼ãƒ•ãƒ­ãƒ³ãƒˆãƒ“ãƒ«ãƒ‰æˆæœç‰©ï¼‰
    </div>
  </div>
</body>
</html>
